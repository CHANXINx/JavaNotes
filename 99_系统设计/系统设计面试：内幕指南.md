## 第01章 | 从0到百万用户

### 总结：
1. 保持Web层无状态；
2. 为每一层建立冗余；
3. 尽可能缓存数据；
4. 支持多个数据中心；
5. 在CDN中托管静态数据；
6. 通过分片扩展数据层；
7. 将层拆分成单独的服务；
8. 监控系统并使用自动化工具。

## 第02章 | 粗略估算
### 粗略估算
常见的粗略估算问题包括：日活DAU、QPS、峰值QPS、存储、缓存、服务器梳理等。

#### 案例一：估算Twitter的查询量和存储需求
- 每月活跃用户为3亿。
- 50%的用户每天使用 Twitter。
- 用户平均每天发布2条推文。
- 10%的推文包含媒体。
- 数据存储时间为5年。

每月用户为3亿，50%的用户每天使用，则日活DAU为`3亿 × 50% = 1.5亿`。
用户平均每天发布2条推文，则推文QPS为`1.5亿 × 2 / 24h / 3600s = 3500`
峰值QPS = QPS×2  = 7000

推文平均大小为：
- 推文ID = 64字节、文本 = 140字节、 媒体 1MB

每天会发布3亿条推文，则每日媒体存储需求为`1.5亿 × 2 × 10% × 1MB = 30TB`
5年媒体存储需求为`30TB × 365 × 5 = 约55PB`

## 第03章 | 系统设计面试框架

>[!IMPORTANT]
>- **有效的系统设计面试更多地体现了一个人的合作能力、在压力下工作的能力以及以建设性方式解决模糊问题的能力。**
>- **提出好问题也是一项重要的技能！**

### 有效系统设计面试的4个步骤
#### 第1步：了解问题并确定设计范围
**不要在没彻底理解需求的情况下回答问题**！在回答问题之前，请提出正确的问题、会做出适当的假设，并收集建立一个系统所需的所有信息。

有助于开展工作的问题清单：
1. **要开发哪些特定功能？** 开发一个完整的系统是不可能的！因此，往往是针对于某个系统的特定关键功能进行开发。
2. **产品有多少用户？** 弄清楚产品的DAU、QPS大致是多少很有必要，这样能避免过度设计。
3. **公司预计扩大规模的速度如何？3个月、6个月和1年后的预期规模是多少？** 弄清扩张速度很有必要，这样能合理设计数据库等资源，例如避免扩张导致数据库分片的频繁数据迁移。
4. **公司的技术栈是？可以利用哪些现有的服务来简化设计？** 

#### 第2步：提出高层次的设计方案并获得认同
- 想出一个初步的设计蓝图，并征求反馈意见。
- 画出关键组件的框图，如客户端、API、服务器、数据存储、缓存等。
- 做一些粗略计算，以评估设计蓝图是否符合规模限制。

#### 第3步：深入设计
#### 第4步：总结
1. **面试官可能希望你找出系统的瓶颈，并讨论潜在的改进**。
2. **给面试官回顾一下你的设计可能是有用的**。
3. **错误情况（服务器故障、网络丢失等）值得讨论**。
4. **运营问题也值得一提。如何监控指标和错误日志？系统如何推广**？
5. **当规模继续扩大将如何处理**，也是一个有趣的话题。


## 第04章 | 设计一个限流器